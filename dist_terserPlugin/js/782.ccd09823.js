"use strict";(self.webpackChunkfinancial_system=self.webpackChunkfinancial_system||[]).push([[782],{16782:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var r=a(34525),n=a(28905),s=a(42325);const o=Object.freeze({}),i=Object.freeze([{prop:"name",label:"姓名",width:120},{label:"身份证",prop:"identity_card"},{prop:"status",label:"合同状态",width:120},{label:"操作",prop:"operation",width:300}].map((t=>({...t,align:"center"}))));var u=a(54011),l={name:"contract",mixins:[n.Z,r.Z],data(){return{columns:i,tableConfig:o,tableData:[]}},created(){this.load()},methods:{beforeInit(){return this.loadUrl="/contract/list",!0},async createFile(t){await(0,u.tn)(t),this.$message.success("生成合同成功"),this.load()},async downloadFile(t){let e=await(0,u.YB)(t);if(!e?.data?.data?.url)throw new Error("无法获取Url");const a=e?.data?.data?.url.replace("/api","");let r=await(0,u.Pv)(a);(0,s._2)(r.data,"贷款合同.docx"),this.$message.success("下载合同成功")}}},p=(0,a(1001).Z)(l,(function(){var t=this,e=t._self._c;return e("div",[e("ESearch",{attrs:{placeholder:"请输入姓名"},on:{setValue:t.setQuery}}),e("ETable",{attrs:{usePage:"",pager:t.frontPager,data:t.tableData,border:"",columns:t.columns,config:t.tableConfig},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange},scopedSlots:t._u([{key:"status",fn:function({row:a}){return[e("el-tag",{attrs:{type:t._f("statusColor")(a.status)}},[t._v(t._s(t._f("status")(a.status)))])]}},{key:"operation",fn:function({row:a}){return[e("el-button",{attrs:{type:"primary",disabled:5!==a.status},on:{click:function(e){return t.createFile(a.id)}}},[t._v("生成合同")]),e("el-button",{attrs:{type:"success",disabled:7!==a.status},on:{click:function(e){return t.downloadFile(a.id)}}},[t._v("下载合同")])]}}])})],1)}),[],!1,null,null,null).exports},54011:function(t,e,a){a.d(e,{AK:function(){return u},Bo:function(){return s},Pv:function(){return f},QA:function(){return n},SD:function(){return p},YB:function(){return g},ey:function(){return l},i0:function(){return d},pV:function(){return i},q3:function(){return o},rX:function(){return c},tn:function(){return h}});var r=a(2032);const n=t=>r.Z.post("/loan/create",t,{fullLoading:!0}),s=t=>r.Z.put("/loan/update",t),o=t=>r.Z.delete("/loan/delete/"+t),i=t=>r.Z.post("/loan/submitToApprove/",{id:t}),u=(t,e)=>r.Z.post("/approve/first/pass",{appId:t,loanId:e}),l=t=>r.Z.post("/approve/first/reject",{appId:t}),p=t=>r.Z.get("/loan/query?id="+t),c=t=>r.Z.post("/approve/end/pass",{appId:t}),d=t=>r.Z.post("/approve/end/reject",{appId:t}),h=t=>r.Z.post("/contract/createFile",{id:t}),g=t=>r.Z.get(`/contract/download?id=${t}`),f=t=>(0,r.Z)({url:t,responseType:"blob"})},34525:function(t,e,a){var r=a(2032);e.Z={data(){return{showLoading:!1}},methods:{beforeInit(){return!1},async load(){if(!this.beforeInit())return;this.showLoading=!0;let t=await(0,r.Z)(this.loadUrl,{params:this.apiPager});this.showLoading=!1,this.tableData=t.data.data,this.setTotal(t.data.pager.rows)}}}},28905:function(t,e,a){var r=a(42325);e.Z={data(){return{pager:{currentPage:1,pageSizes:[10,20,30,40],pageSize:10,layout:"total, sizes, prev, pager, next, jumper",total:100,query:""}}},methods:{handleSizeChange(t){this.pager.pageSize=t,this.pager.currentPage=1,this.load()},handleCurrentChange(t){this.pager.currentPage=t,this.load()},setTotal(t){this.pager.total=t},setQuery(t){this.pager.query=t,this.pager.currentPage=1,this.load()}},computed:{frontPager(){return(0,r.I8)(this.$data.pager)},apiPager(){let t={pageNo:this.pager.currentPage,pageSize:this.pager.pageSize};return this.pager.query&&""!==this.pager.query.trim()&&(t.name=this.pager.query),t}}}}}]);